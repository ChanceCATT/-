<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>九州沖繩 11 天芙莉蓮風格之旅指南 (含地圖版)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Font Awesome (for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts: Noto Sans TC + Serif for Frieren vibe -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        frieren: {
                            50: '#f9f8f4', // Parchment light
                            100: '#f0efe9',
                            200: '#e2e0d6',
                            300: '#cqcbc0',
                            500: '#8c887d', // Text secondary
                            700: '#5a564c', // Text primary
                            800: '#46433b',
                            900: '#2d2b26', // Dark accents
                            gold: '#d4af37', // Magic accent
                            accent: '#88a0a8', // Subtle blue/green
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                        serif: ['"Noto Serif TC"', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f9f8f4;
            color: #46433b;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        .hide-scroll::-webkit-scrollbar {
            display: none;
        }
        .hide-scroll {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .timeline-line {
            content: '';
            position: absolute;
            top: 20px;
            bottom: 20px;
            left: 23px; /* Center with the icon */
            width: 2px;
            background-color: #e2e0d6;
            z-index: 0;
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }
        .map-btn:hover {
            transform: translateY(-1px);
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-frieren-100 border-b border-frieren-200 sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
            <div>
                <h1 class="font-serif text-xl font-bold text-frieren-900 tracking-wide">旅程の書</h1>
                <p class="text-xs text-frieren-500">11 天九州沖繩．芙莉蓮風格之旅 (Google Map 連動版)</p>
            </div>
            <button id="view-toggle" class="text-frieren-700 hover:text-frieren-gold transition-colors p-2" onclick="toggleView()">
                <i class="fa-solid fa-chart-pie text-xl"></i>
            </button>
        </div>
        
        <!-- Day Navigation -->
        <div class="w-full overflow-x-auto hide-scroll border-t border-frieren-200 bg-white shadow-sm">
            <div class="flex space-x-2 p-2 min-w-max" id="day-nav-container">
                <!-- JS will populate buttons here -->
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-4xl mx-auto w-full p-4">
        
        <!-- View 1: Timeline / Itinerary -->
        <div id="itinerary-view" class="space-y-6">
            
            <!-- Day Context & Strategy Card -->
            <div class="bg-white p-6 rounded-lg card-shadow border border-frieren-200">
                <div class="flex justify-between items-start">
                    <h2 class="font-serif text-2xl font-bold text-frieren-900 mb-2" id="current-day-title">Day 1</h2>
                    <span id="current-day-date" class="text-sm font-mono text-frieren-500 bg-frieren-50 px-2 py-1 rounded"></span>
                </div>
                <div class="flex items-start gap-3 text-frieren-700 mt-2 bg-frieren-50 p-3 rounded border border-frieren-100">
                    <i class="fa-solid fa-lightbulb text-frieren-gold mt-1 flex-shrink-0"></i>
                    <div class="text-sm leading-relaxed">
                        <span class="font-bold text-frieren-800 block mb-1">攻略重點：</span>
                        <span id="current-day-strategy">載入中...</span>
                    </div>
                </div>
            </div>

            <!-- Timeline Container -->
            <div class="relative bg-white rounded-lg card-shadow border border-frieren-200 p-4 sm:p-6" id="timeline-container">
                <!-- JS populates timeline here -->
            </div>
        </div>

        <!-- View 2: Analytics / Grimoire Stats -->
        <div id="analytics-view" class="hidden space-y-6">
            <div class="bg-white p-6 rounded-lg card-shadow border border-frieren-200">
                <h2 class="font-serif text-xl font-bold text-frieren-900 mb-4">冒險分析 (Journey Analytics)</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Chart 1: Composition -->
                    <div class="flex flex-col items-center">
                        <h3 class="text-sm font-bold text-frieren-700 mb-2">冒險元素構成</h3>
                        <div class="chart-container">
                            <canvas id="compositionChart"></canvas>
                        </div>
                    </div>

                    <!-- Chart 2: Pacing -->
                    <div class="flex flex-col items-center">
                        <h3 class="text-sm font-bold text-frieren-700 mb-2">每日強度 (體力消耗)</h3>
                        <div class="chart-container">
                            <canvas id="pacingChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Logistics Summary Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-lg border border-frieren-200 shadow-sm">
                    <h3 class="font-bold text-frieren-800 mb-2 flex items-center gap-2">
                        <i class="fa-solid fa-suitcase text-orange-500"></i> 行李策略
                    </h3>
                    <ul class="text-sm text-frieren-600 list-disc list-inside space-y-1">
                        <li><strong>Day 3:</strong> 博多站筑紫口寄放，輕裝去由布院。</li>
                        <li><strong>Day 4:</strong> 姊姊載行李回福岡，夫妻兩手空空逛街。</li>
                        <li><strong>Day 11:</strong> 機場國內線買完伴手禮再託運。</li>
                    </ul>
                </div>
                <div class="bg-white p-4 rounded-lg border border-frieren-200 shadow-sm">
                    <h3 class="font-bold text-frieren-800 mb-2 flex items-center gap-2">
                        <i class="fa-solid fa-clock text-blue-500"></i> 關鍵預約
                    </h3>
                    <ul class="text-sm text-frieren-600 list-disc list-inside space-y-1">
                        <li><strong>由布院之森:</strong> 1/1 準時搶票。</li>
                        <li><strong>九州自然動物園:</strong> 叢林巴士 (Jungle Bus)。</li>
                        <li><strong>餐廳:</strong> NIKUICHI 藥院燒肉 (Day 4 19:30)。</li>
                    </ul>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- Detailed Itinerary Data with Map Queries ---
        const itineraryData = [
            {
                day: 1,
                date: "1/30 (五)",
                title: "沖繩登陸：熱鬧居酒屋",
                strategy: "班機晚到，重點在快速從機場移動到壺川，放行李後直奔國際通。記得在便利商店買好明天的早餐。",
                intensity: 6,
                events: [
                    { time: "19:10", title: "抵達那霸機場 (OKA)", mapQuery: "那霸機場", desc: "長榮 BR186 抵達。入境約 30-40 分。前往國內線航廈 2F 搭單軌。", type: "transport", icon: "fa-plane" },
                    { time: "20:00", title: "搭乘單軌列車 (Yui-Rail)", mapQuery: "那霸機場站 單軌", desc: "目標：壺川站 (Tsubogawa)，車程約 10 分鐘。", type: "transport", icon: "fa-train" },
                    { time: "20:15", title: "Check-in: Mercure Okinawa Naha", mapQuery: "Mercure Okinawa Naha", desc: "飯店就在壺川站旁，走路 1 分鐘。快速放好行李。", type: "stay", icon: "fa-bed" },
                    { time: "20:45", title: "晚餐：國際通屋台村", mapQuery: "國際通屋台村", desc: "搭計程車前往 (約 ¥800)。推薦：苦瓜炒蛋、阿古豬煎餃、海葡萄。氣氛熱鬧！", type: "food", icon: "fa-utensils" },
                    { time: "22:00", title: "深夜採購：唐吉訶德", mapQuery: "唐吉訶德 國際通店", desc: "國際通店 (24H)。買這幾天要喝的飲料、零食。", type: "shopping", icon: "fa-bag-shopping" },
                    { time: "23:00", title: "回飯店休息", mapQuery: "Mercure Okinawa Naha", desc: "搭計程車回壺川美居。敷個面膜，準備明天早起。", type: "stay", icon: "fa-moon" }
                ]
            },
            {
                day: 2,
                date: "1/31 (六)",
                title: "沖繩北部：深海巨鯊與神木",
                strategy: "配合 OAS 巴士時刻表，精準行動。OAS 巴士需預訂。海豚秀改看 13:00 場次以銜接鯨鯊餵食。",
                intensity: 9,
                events: [
                    { time: "07:45", title: "前往縣廳北口巴士站", mapQuery: "縣廳北口 巴士站 Ryubo百貨", desc: "壺川站 -> 縣廳前站。出站下樓至 Ryubo 百貨對面巴士站。", type: "transport", icon: "fa-person-walking" },
                    { time: "08:15", title: "OAS 巴士發車", mapQuery: "縣廳北口 巴士站", desc: "準時發車，前往紀念公園前 (美ら海水族館)。", type: "transport", icon: "fa-bus" },
                    { time: "10:10", title: "美麗海水族館 (Part 1)", mapQuery: "沖繩美麗海水族館", desc: "進館直衝「黑潮之海」，趁人少先拍鯨鯊合照。", type: "sightseeing", icon: "fa-fish" },
                    { time: "11:30", title: "備瀨福木林道", mapQuery: "備瀨福木林道", desc: "蓋章暫離水族館。走路 10 分鐘去綠色隧道散步、避開人潮吃午餐。", type: "sightseeing", icon: "fa-tree" },
                    { time: "13:00", title: "海豚劇場 (Okichan)", mapQuery: "海洋博公園 海豚劇場", desc: "看 13:00 的免費海豚表演 (約 20 分鐘)。", type: "sightseeing", icon: "fa-water" },
                    { time: "14:00", title: "補看館內展區", mapQuery: "沖繩美麗海水族館", desc: "珊瑚礁區、深海區。最後回到黑潮之海卡位。", type: "sightseeing", icon: "fa-eye" },
                    { time: "15:00", title: "鯨鯊餵食秀", mapQuery: "沖繩美麗海水族館 黑潮之海", desc: "壓軸重頭戲，看鯨鯊垂直進食。15:15 結束後直接往巴士站走。", type: "sightseeing", icon: "fa-camera" },
                    { time: "16:00", title: "OAS 巴士回程", mapQuery: "紀念公園前 巴士站", desc: "上車補眠。回到縣廳北口。", type: "transport", icon: "fa-bus" },
                    { time: "19:00", title: "晚餐：國際通", mapQuery: "那霸 國際通", desc: "燒肉、牛排或居酒屋。隨意逛逛。", type: "food", icon: "fa-utensils" }
                ]
            },
            {
                day: 3,
                date: "2/1 (日)",
                title: "跨越海洋：九州登陸",
                strategy: "【關鍵戰術】博多站寄放行李。只帶過夜包去由布院，讓搭乘觀光列車更舒適。",
                intensity: 8,
                events: [
                    { time: "08:30", title: "抵達那霸機場", mapQuery: "那霸機場 國內線航廈", desc: "天馬航空櫃檯報到。買飯糰當早餐。", type: "transport", icon: "fa-plane-departure" },
                    { time: "10:15", title: "飛往福岡 (BC498)", mapQuery: "福岡機場", desc: "告別沖繩，前往九州。", type: "transport", icon: "fa-plane" },
                    { time: "12:40", title: "博多站：寄放行李", mapQuery: "博多站 筑紫口 投幣式置物櫃", desc: "前往「筑紫口」置物櫃區。鎖入大行李，只帶過夜包。", type: "strategy", icon: "fa-key" },
                    { time: "13:00", title: "午餐：車站便當", mapQuery: "博多站 駅弁", desc: "買知名的「柏飯 (かしわめし)」便當帶上車吃。", type: "food", icon: "fa-bento" },
                    { time: "14:38", title: "由布院之森 5號", mapQuery: "博多站", desc: "夢幻綠色列車。車上必吃：大豆冰淇淋。", type: "transport", icon: "fa-train" },
                    { time: "16:50", title: "抵達由布院", mapQuery: "由布院站", desc: "與姊姊一家在車站前會合 (Kiss & Ride區)。", type: "transport", icon: "fa-car" },
                    { time: "17:00", title: "入住：由布院山響", mapQuery: "由布院温泉 山響 Yamahibiki", desc: "姊姊開車接送。家族大合體。", type: "stay", icon: "fa-house-user" },
                    { time: "18:30", title: "晚餐：溫泉懷石", mapQuery: "由布院温泉 山響", desc: "旅館內享用豐盛晚餐。", type: "food", icon: "fa-utensils" },
                    { time: "20:30", title: "溫泉時光", mapQuery: "由布院温泉 山響", desc: "享受露天風呂，欣賞星空。", type: "stay", icon: "fa-hot-tub-person" }
                ]
            },
            {
                day: 4,
                date: "2/2 (一)",
                title: "大分探險：獅子與散策",
                strategy: "兵分兩路策略：動物園後姊姊載行李回福岡，夫妻倆「兩手空空」享受由布院散步與巴士漫遊。",
                intensity: 8,
                events: [
                    { time: "09:10", title: "九州自然動物園", mapQuery: "九州自然動物園 African Safari", desc: "姊姊開車前往。必搭 Jungle Bus 餵食獅子。", type: "sightseeing", icon: "fa-paw" },
                    { time: "12:30", title: "兵分兩路 @ 由布院", mapQuery: "由布院站", desc: "姊姊載行李回福岡。夫妻下車開始散步。", type: "strategy", icon: "fa-handshake" },
                    { time: "12:40", title: "午餐：路邊小吃", mapQuery: "由布院 金賞可樂餅", desc: "金賞可樂餅、豐後牛握壽司、Milch 起司塔。", type: "food", icon: "fa-burger" },
                    { time: "13:30", title: "由布院散策", mapQuery: "由布院 湯之坪街道", desc: "湯之坪街道、Snoopy 茶屋、金鱗湖 (看湖光山色)。", type: "sightseeing", icon: "fa-person-walking" },
                    { time: "16:00", title: "高速巴士回博多", mapQuery: "由布院站前巴士中心", desc: "搭乘「由布院號」 (需預約)。車上補眠。", type: "transport", icon: "fa-bus" },
                    { time: "18:30", title: "取回大行李", mapQuery: "博多巴士總站", desc: "博多站置物櫃取行李，搭計程車去飯店 (天神南 Quintessa)。", type: "strategy", icon: "fa-suitcase" },
                    { time: "19:30", title: "晚餐：NIKUICHI 藥院", mapQuery: "薬院焼肉 NIKUICHI", desc: "已預約。高CP值黑毛和牛燒肉，離飯店很近。", type: "food", icon: "fa-fire" }
                ]
            },
            {
                day: 5,
                date: "2/3 (二)",
                title: "紳士理容與海洋世界",
                strategy: "上午分開行動，下午全家會合。體驗福岡的都會與海洋。",
                intensity: 6,
                events: [
                    { time: "11:00", title: "Men’s salon Zina", mapQuery: "Men’s salon Zina 天神", desc: "先生理髮修容 (天神)。太太逛天神地下街/PARCO。", type: "sightseeing", icon: "fa-scissors" },
                    { time: "13:30", title: "姊姊還車 & 會合", mapQuery: "博多站", desc: "約在博多站或天神站集合。", type: "transport", icon: "fa-users" },
                    { time: "14:00", title: "前往海之中道", mapQuery: "海之中道站", desc: "搭 JR (鹿兒島本線轉香椎線) 前往。", type: "transport", icon: "fa-train" },
                    { time: "15:00", title: "海洋世界海之中道", mapQuery: "海洋世界海之中道", desc: "純白設計水族館。必看：海豚秀、玄界灘大水槽。", type: "sightseeing", icon: "fa-water" },
                    { time: "19:00", title: "晚餐：博多牛腸鍋", mapQuery: "博多もつ鍋 前田屋", desc: "推薦：前田屋 或 大山 (Oyama)。", type: "food", icon: "fa-bowl-food" }
                ]
            },
            {
                day: 6,
                date: "2/4 (三)",
                title: "糸島絕景與海鮮",
                strategy: "利用 West Coast Liner 直達巴士，不開車也能玩糸島。",
                intensity: 5,
                events: [
                    { time: "09:53", title: "搭乘 West Coast Liner", mapQuery: "天神三丁目 巴士站", desc: "天神三丁目搭車，直達糸島。", type: "transport", icon: "fa-bus" },
                    { time: "11:10", title: "午餐：糸島海鮮堂", mapQuery: "糸島海鮮堂 二見浦本店", desc: "二見浦本店。特上海鮮丼、烤牡蠣。", type: "food", icon: "fa-fish" },
                    { time: "12:30", title: "二見浦海岸散策", mapQuery: "櫻井二見浦", desc: "櫻井二見浦 (白色鳥居、夫婦岩)、Palm Beach 天使翅膀。", type: "sightseeing", icon: "fa-camera" },
                    { time: "13:30", title: "下午茶：糸島茶房", mapQuery: "糸島茶房", desc: "海景舒芙蕾鬆餅，非常放鬆。", type: "food", icon: "fa-mug-hot" },
                    { time: "15:30", title: "巴士回程", mapQuery: "二見浦 巴士站", desc: "搭巴士返回天神。", type: "transport", icon: "fa-bus" },
                    { time: "18:00", title: "晚餐：天神周邊", mapQuery: "ひょうたん寿司 天神", desc: "葫蘆壽司 (ひょうたん寿司) 或 天神荷爾蒙。", type: "food", icon: "fa-utensils" }
                ]
            },
            {
                day: 7,
                date: "2/5 (四)",
                title: "古都、法棍與溫泉",
                strategy: "太宰府參拜，買傳說中的明太子法棍，晚上泡私人溫泉。",
                intensity: 6,
                events: [
                    { time: "09:30", title: "搭乘「旅人號」", mapQuery: "西鐵福岡(天神)站", desc: "西鐵天神站出發前往太宰府。", type: "transport", icon: "fa-train" },
                    { time: "10:15", title: "太宰府天滿宮", mapQuery: "太宰府天滿宮", desc: "參拜學問之神。吃梅枝餅 (Kasanoya)、看隈研吾星巴克。", type: "sightseeing", icon: "fa-torii-gate" },
                    { time: "12:30", title: "午餐：暖暮拉麵", mapQuery: "暖暮拉麵 太宰府站前店", desc: "太宰府站前店 (曾獲九州第一)。", type: "food", icon: "fa-bowl-rice" },
                    { time: "15:00", title: "Full Full 明太子法棍", mapQuery: "Full Full 天神胖", desc: "回天神去 Full Full 天神店購買。", type: "food", icon: "fa-bread-slice" },
                    { time: "17:30", title: "港溫泉 波葉之湯", mapQuery: "港溫泉 波葉之湯", desc: "博多埠頭。預約家族風呂，泡湯喝牛奶。", type: "sightseeing", icon: "fa-hot-tub-person" },
                    { time: "20:00", title: "晚餐：中洲屋台", mapQuery: "中洲屋台街", desc: "體驗路邊攤：關東煮、炒拉麵。", type: "food", icon: "fa-beer" }
                ]
            },
            {
                day: 8,
                date: "2/6 (五)",
                title: "北九州關門海峽",
                strategy: "特別安排在週五，為了吃到唐戶市場的限定壽司市集。",
                intensity: 7,
                events: [
                    { time: "09:00", title: "搭乘 JR 音速號", mapQuery: "博多站", desc: "博多 -> 門司港站。", type: "transport", icon: "fa-train" },
                    { time: "10:30", title: "搭船跨海", mapQuery: "門司港 碼頭", desc: "門司港 -> 下關唐戶。", type: "transport", icon: "fa-ship" },
                    { time: "10:40", title: "唐戶市場 (週五限定)", mapQuery: "唐戶市場", desc: "活きいき馬関街。買握壽司、河豚刺身在海邊吃。", type: "food", icon: "fa-sushi" },
                    { time: "12:15", title: "海響館", mapQuery: "下關市立下關水族館 海響館", desc: "看海豚海獅秀、企鵝村。", type: "sightseeing", icon: "fa-water" },
                    { time: "14:30", title: "門司港懷舊散策", mapQuery: "門司港懷舊", desc: "搭船回門司港。看香蕉人像、舊三井俱樂部。", type: "sightseeing", icon: "fa-building" },
                    { time: "15:40", title: "小倉城 & 旦過市場", mapQuery: "小倉城", desc: "回程順路去小倉逛逛。", type: "sightseeing", icon: "fa-store" },
                    { time: "19:00", title: "晚餐：小倉/博多", mapQuery: "小倉鐵鍋餃子 本店", desc: "小倉鐵鍋餃子，或回博多吃。", type: "food", icon: "fa-dumpling" }
                ]
            },
            {
                day: 9,
                date: "2/7 (六)",
                title: "運河城決戰與購物",
                strategy: "《我推》一番賞發售日，上午戰鬥，下午補貨。",
                intensity: 7,
                events: [
                    { time: "09:30", title: "博多運河城 Namco", mapQuery: "Bandai Namco Cross Store Hakata", desc: "直奔南館 B1 Bandai Namco Cross Store。", type: "strategy", icon: "fa-bullseye" },
                    { time: "10:00", title: "一番賞決戰", mapQuery: "博多運河城", desc: "目標：A賞小愛模型！排隊抽獎。", type: "shopping", icon: "fa-star" },
                    { time: "13:00", title: "櫛田神社", mapQuery: "櫛田神社", desc: "參拜巨大裝飾山笠。順路去旁邊的 Full Full 買麵包。", type: "sightseeing", icon: "fa-torii-gate" },
                    { time: "15:00", title: "天神大採購", mapQuery: "福岡 PARCO", desc: "PARCO (動漫區)、Mina 天神 (Loft/Uniqlo)。", type: "shopping", icon: "fa-bag-shopping" },
                    { time: "19:00", title: "晚餐：極味屋 / 燒肉", mapQuery: "極味屋 福岡PARCO店", desc: "漢堡排 (PARCO B1) 或燒肉。", type: "food", icon: "fa-fire" }
                ]
            },
            {
                day: 10,
                date: "2/8 (日)",
                title: "神話與火山 (KKday)",
                strategy: "參加一日遊，解決阿蘇與高千穗交通不便的問題。",
                intensity: 8,
                events: [
                    { time: "07:50", title: "博多站集合", mapQuery: "Oriental Hotel Fukuoka Hakata Station", desc: "筑紫口 Oriental Hotel 前。找舉旗人員。", type: "transport", icon: "fa-flag" },
                    { time: "11:00", title: "高千穗峽", mapQuery: "高千穗峽", desc: "九州最強能量景點。看真名井瀑布。", type: "sightseeing", icon: "fa-water" },
                    { time: "13:30", title: "上色見熊野座神社", mapQuery: "上色見熊野座神社", desc: "螢火之森般的夢幻參道，青苔與石燈籠。", type: "sightseeing", icon: "fa-torii-gate" },
                    { time: "14:50", title: "阿蘇火山口 / 草千里", mapQuery: "阿蘇中岳火山口", desc: "壯觀活火山地貌 (視氣體濃度開放)。", type: "sightseeing", icon: "fa-mountain" },
                    { time: "18:00", title: "返回博多站", mapQuery: "博多站", desc: "行程結束。", type: "transport", icon: "fa-bus" },
                    { time: "18:30", title: "晚餐：博多站內", mapQuery: "牛舌利久 博多", desc: "利久牛舌 或 大山牛腸鍋。", type: "food", icon: "fa-utensils" }
                ]
            },
            {
                day: 11,
                date: "2/9 (一)",
                title: "旅程終章與最後衝刺",
                strategy: "機場國內線航廈是伴手禮一級戰區，務必預留時間。",
                intensity: 5,
                events: [
                    { time: "10:30", title: "悠閒早午餐", mapQuery: "bills 福岡", desc: "bills 福岡 (水上公園) 或 Acros 旁散步。", type: "food", icon: "fa-coffee" },
                    { time: "12:00", title: "最後補貨", mapQuery: "大國藥妝 天神南", desc: "大國藥妝、唐吉訶德。", type: "shopping", icon: "fa-bag-shopping" },
                    { time: "14:30", title: "福岡機場 國內線", mapQuery: "福岡機場 國內線航廈", desc: "【重要】先逛國內線 2F 買努努雞、明太子、博多通饅頭。", type: "shopping", icon: "fa-gift" },
                    { time: "16:00", title: "前往國際線", mapQuery: "福岡機場 國際線航廈", desc: "搭乘免費接駁巴士前往國際線航廈報到。", type: "transport", icon: "fa-bus" },
                    { time: "20:55", title: "登機 (BR101)", mapQuery: "福岡機場 國際線航廈", desc: "滿載而歸，平安回家。", type: "transport", icon: "fa-plane-departure" }
                ]
            }
        ];

        // --- UI Logic ---
        let currentDayIndex = 0;
        let isAnalyticsView = false;

        const typeColors = {
            transport: 'bg-blue-100 text-blue-800 border-blue-200',
            food: 'bg-orange-100 text-orange-800 border-orange-200',
            sightseeing: 'bg-green-100 text-green-800 border-green-200',
            shopping: 'bg-pink-100 text-pink-800 border-pink-200',
            stay: 'bg-indigo-100 text-indigo-800 border-indigo-200',
            strategy: 'bg-frieren-gold/10 text-frieren-900 border-frieren-gold font-bold'
        };

        function init() {
            renderDayNav();
            renderTimeline();
            initCharts();
        }

        function renderDayNav() {
            const container = document.getElementById('day-nav-container');
            container.innerHTML = itineraryData.map((day, index) => `
                <button 
                    onclick="switchDay(${index})"
                    class="px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 whitespace-nowrap flex-shrink-0
                    ${index === currentDayIndex 
                        ? 'bg-frieren-700 text-white shadow-md transform scale-105' 
                        : 'bg-white text-frieren-500 hover:bg-frieren-100 border border-frieren-200'}"
                >
                    Day ${day.day}
                </button>
            `).join('');
            
            const buttons = container.children;
            if(buttons[currentDayIndex]) {
                buttons[currentDayIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }
        }

        function switchDay(index) {
            currentDayIndex = index;
            if (isAnalyticsView) toggleView();
            renderDayNav();
            renderTimeline();
        }

        function renderTimeline() {
            const day = itineraryData[currentDayIndex];
            
            // Header
            document.getElementById('current-day-title').textContent = `Day ${day.day}: ${day.title}`;
            document.getElementById('current-day-date').textContent = day.date;
            document.getElementById('current-day-strategy').textContent = day.strategy;

            // Events
            const container = document.getElementById('timeline-container');
            container.innerHTML = `
                <div class="timeline-line"></div>
                <div class="space-y-6 relative z-10">
                    ${day.events.map(event => `
                        <div class="flex gap-4 group">
                            <!-- Icon -->
                            <div class="flex-shrink-0 w-12 h-12 rounded-full bg-white border-2 border-frieren-200 flex items-center justify-center shadow-sm z-10 group-hover:border-frieren-gold transition-colors">
                                <i class="fa-solid ${event.icon} text-frieren-500 group-hover:text-frieren-gold transition-colors"></i>
                            </div>
                            
                            <!-- Card -->
                            <div class="flex-grow bg-white border border-frieren-100 rounded-lg p-3 hover:shadow-md transition-all duration-300 cursor-default ${event.type === 'strategy' ? 'border-l-4 border-l-frieren-gold bg-yellow-50/30' : ''}">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="font-mono text-sm font-bold text-frieren-gold bg-frieren-50 px-2 rounded">${event.time}</span>
                                    <span class="text-[10px] uppercase tracking-wider px-2 py-0.5 rounded-full ${typeColors[event.type]}">
                                        ${getTypeLabel(event.type)}
                                    </span>
                                </div>
                                <h3 class="font-bold text-frieren-800 leading-tight mb-1 text-base flex justify-between items-center">
                                    ${event.title}
                                    <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(event.mapQuery || event.title)}" 
                                       target="_blank" 
                                       class="map-btn ml-2 text-xs font-normal text-frieren-500 hover:text-blue-600 bg-frieren-50 hover:bg-blue-50 px-2 py-1 rounded border border-frieren-200 hover:border-blue-200 transition-all flex items-center gap-1"
                                       title="在 Google Maps 開啟">
                                        <i class="fa-solid fa-location-dot"></i> 地圖
                                    </a>
                                </h3>
                                <p class="text-sm text-frieren-600 leading-relaxed">${event.desc}</p>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getTypeLabel(type) {
            const labels = {
                transport: '交通',
                food: '美食',
                sightseeing: '景點',
                shopping: '購物',
                stay: '住宿',
                strategy: '重點'
            };
            return labels[type] || type;
        }

        function toggleView() {
            const itView = document.getElementById('itinerary-view');
            const anView = document.getElementById('analytics-view');
            
            if (isAnalyticsView) {
                itView.classList.remove('hidden');
                anView.classList.add('hidden');
            } else {
                itView.classList.add('hidden');
                anView.classList.remove('hidden');
            }
            isAnalyticsView = !isAnalyticsView;
        }

        // --- Charts ---
        function initCharts() {
            const typeCounts = { transport: 0, food: 0, sightseeing: 0, shopping: 0 };
            itineraryData.forEach(day => {
                day.events.forEach(e => {
                    if (typeCounts[e.type] !== undefined) typeCounts[e.type]++;
                });
            });

            // Composition Chart
            const ctx1 = document.getElementById('compositionChart').getContext('2d');
            new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['交通', '美食', '景點', '購物'],
                    datasets: [{
                        data: [typeCounts.transport, typeCounts.food, typeCounts.sightseeing, typeCounts.shopping],
                        backgroundColor: ['#93c5fd', '#fdba74', '#86efac', '#f9a8d4'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            // Pacing Chart
            const ctx2 = document.getElementById('pacingChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: itineraryData.map(d => `Day ${d.day}`),
                    datasets: [{
                        label: '冒險強度',
                        data: itineraryData.map(d => d.intensity),
                        backgroundColor: '#e2e0d6',
                        hoverBackgroundColor: '#d4af37',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { display: false, max: 10 },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>